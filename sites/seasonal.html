<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Seasonal Planting Calendar â€¢ Patch &amp; Pot (UK)</title>
  <meta name="description" content="UK seasonal planting calendar for small spaces with Scotland, Ireland, England and Wales variants: what to sow, plant and harvest, plus pest watch." />

  <!-- Global site CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Page locks (accessibility + readability + responsive grid) -->
  <style>
    :root{
      --ink:#ffffff;            /* hard white text on dark background */
      --muted:#d5e2d8;
      --panel:#121712;
      --panel2:#161d18;
      --line:#2a322e;
      --accent:#35c26a;
    }

    /* force readable text everywhere on this page */
    body, main, footer, header,
    h1,h2,h3,h4,h5,h6,
    p, small, label, span, li, div,
    input, select, button, a { color: var(--ink) !important; }

    html,body { background:#0b100d; }
    .wrap{max-width:1140px;margin:0 auto;padding:16px 20px}

    .pp-sub{color:var(--muted)!important;margin:0 0 .8rem}

    .pp-card{background:var(--panel2);border:1px solid var(--line);border-radius:16px;padding:1rem;margin:1rem 0}
    .pp-toolbar{display:grid;grid-template-columns:1fr auto;gap:10px 14px;align-items:center}
    .pp-toolbar .left{display:flex;flex-wrap:wrap;gap:.6rem;align-items:center}
    .pp-toolbar .right{display:flex;flex-wrap:wrap;gap:.6rem;align-items:center;justify-content:flex-end}
    .pp-select,.pp-search{background:#0c100e;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:.55rem .7rem}
    .pp-help{color:var(--muted)!important;margin:.6rem 0 0}

    .btn{display:inline-flex;align-items:center;gap:.5rem;border-radius:10px;padding:.6rem .9rem;font-weight:700;border:1px solid #294b3a;background:#2f8f4a;color:#0b140f}
    .btn[disabled]{opacity:.65;cursor:not-allowed}

    .pp-pestwatch{background:var(--panel);border:1px solid var(--line);border-left:4px solid var(--accent);
      border-radius:14px;padding:1rem;margin:1rem 0}
    .pp-pestwatch small{color:var(--muted)!important}
    .pp-pestwatch ul{margin:.5rem 0 0;padding-left:1.1rem}

    .pp-legend{display:flex;gap:18px;align-items:center;margin:.6rem 0 .6rem}
    .pp-legend em{font-style:normal;color:var(--muted)!important}

    .note-rotate{color:var(--muted)!important;margin:.3rem 0 1rem}

    /* Calendar container is scrollable when it cannot fit (prevents Dec cut-off) */
    .cal-scroller{overflow-x:auto; -webkit-overflow-scrolling:touch; border-radius:16px; border:1px solid var(--line)}
    .pp-calendar{
      min-width: 100%;
      width: max(980px, 100%); /* baseline width large enough for 12 cols */
      display:grid;
      grid-template-columns:minmax(220px,1.2fr) repeat(12, minmax(64px,1fr));
      gap:2px;background:#0f1512;
    }
    .pp-row{display:contents}
    .pp-head,.pp-cell{
      padding:.55rem .6rem;border:1px solid var(--line);font-size:.95rem;line-height:1.3;white-space:normal;word-break:break-word
    }
    .pp-head{font-weight:800;background:#121815;text-align:center}
    .pp-cell{font-size:1.05rem;text-align:center}
    .pp-crop{background:#121815;font-weight:800;text-align:left}
    .pp-crop .name{display:block}
    .pp-tags{display:block;font-size:.82rem;color:var(--muted)!important;font-weight:600;margin-top:.15rem}

    /* Missing-files panel */
    .pp-error{background:#3a1f22;border:1px solid #6d2b2b;color:#ffd7d7;border-radius:12px;padding:.9rem 1rem;margin-top:12px;display:none}
    .pp-error code{color:#ffecec}

    /* Footer: pot centred, text under, centred */
    footer{border-top:1px solid #142116;margin-top:28px;background:#0a0f0c;text-align:center;padding:18px 0}
    .footer-inner{display:flex;flex-direction:column;align-items:center;gap:6px}
    .footer-pot{width:34px;height:34px;object-fit:contain}

    /* Phone tweaks */
    @media (max-width:900px){
      .pp-toolbar{grid-template-columns:1fr}
      .pp-toolbar .right{justify-content:flex-start}
      .pp-calendar{grid-template-columns:minmax(200px,1.1fr) repeat(12, minmax(56px,1fr))}
    }
    /* Small phones & landscape: compress more so 12 months fit */
    @media (max-width:680px){
      .pp-calendar{grid-template-columns:minmax(188px,1.1fr) repeat(12, minmax(48px,1fr))}
      .pp-head{font-size:.85rem}
      .pp-cell{font-size:.98rem}
    }
  </style>
</head>
<body>

  <!-- HEADER PARTIAL -->
  <div data-include="partials/header.html"></div>

  <main class="wrap" id="maincontent">
    <h1>Seasonal Planting Calendar (UK)</h1>
    <p class="pp-sub">Small-space sowing, planting &amp; harvesting with regional variants for <strong>Scotland</strong>, <strong>Ireland</strong>, <strong>England</strong> and <strong>Wales</strong>.</p>

    <section class="pp-card">
      <div class="pp-toolbar" role="group" aria-label="Region and filters">
        <div class="left">
          <label for="pp-region">Region:</label>
          <select id="pp-region" class="pp-select" aria-label="Choose your region">
            <option value="scotland">Scotland</option>
            <option value="ireland">Ireland</option>
            <option value="england">England</option>
            <option value="wales">Wales</option>
          </select>

          <input id="pp-search" class="pp-search" type="search" placeholder="Search crops (e.g., carrot, basil)â€¦" aria-label="Search crops by name" />

          <label for="pp-category" class="sr-only" style="position:absolute;left:-9999px">Category</label>
          <select id="pp-category" class="pp-select" aria-label="Filter by category">
            <option value="all">All categories</option>
            <option value="leafy">Leafy</option>
            <option value="roots">Roots</option>
            <option value="legumes">Legumes</option>
            <option value="fruit">Fruiting veg</option>
            <option value="alliums">Alliums</option>
            <option value="herbs">Herbs</option>
            <option value="softfruit">Soft fruit</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div class="right">
          <button id="pp-make-pdf" class="btn" type="button" disabled>ðŸ“„ Download PDF</button>
          <label style="display:inline-flex;align-items:center;gap:.4rem">
            <input type="checkbox" id="pp-this-month" /> <span>Show activity this month only</span>
          </label>
        </div>
      </div>
      <p class="pp-help">Tip: pick a <strong>Region</strong>, type to <strong>search</strong>, choose a <strong>Category</strong>, or toggle <strong>This month only</strong> for a focused view.</p>
    </section>

    <section class="pp-pestwatch" id="pp-pestwatch" aria-labelledby="pestwatch-title">
      <h3 id="pestwatch-title">Pest Watch â€“ <span id="pp-month-name"></span> (<span id="pp-region-name"></span>)</h3>
      <small>Small spaces edition</small>
      <ul><li>Loadingâ€¦</li></ul>
    </section>

    <section class="pp-card" aria-labelledby="today-title">
      <h2 id="today-title">What Can I Plant Today?</h2>
      <p class="pp-month-hint" id="pp-month-hint"></p>
      <ul id="pp-today-list" class="pp-list" style="list-style:none;padding:0;margin:0"></ul>
    </section>

    <div class="pp-legend" aria-hidden="true">
      <span>ðŸŒ± <em>Sow</em></span>
      <span>ðŸª´ <em>Plant</em></span>
      <span>ðŸ¥• <em>Harvest</em></span>
    </div>

    <p class="note-rotate">On a narrow phone, rotate to landscape (or swipe) to see all months.</p>

    <section aria-labelledby="calendar-title">
      <h2 id="calendar-title">Seasonal Planting Calendar</h2>
      <div class="cal-scroller">
        <div class="pp-calendar" id="pp-calendar" role="table" aria-label="Seasonal planting calendar"></div>
      </div>
      <div id="pp-error" class="pp-error"></div>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="footer-inner">
      <img src="img/patchandpot-icon.png" alt="Patch &amp; Pot icon" class="footer-pot" onerror="this.style.display='none'">
      <p>Â© 2025 Patch &amp; Pot | Created by Grant Cameron Anthony</p>
    </div>
  </footer>

  <!-- Load header partial (no style changes here) -->
  <script>
    (function(){
      const holder=document.querySelector('[data-include="partials/header.html"]');
      if(!holder) return;
      fetch('partials/header.html',{cache:'no-store'})
        .then(r=>r.text()).then(html=>{
          holder.outerHTML=html;
          const header=document.getElementById('siteHeader'); if(!header) return;
          const toggle=header.querySelector('.menu-toggle');
          const nav=header.querySelector('#primaryNav');
          const fn=(location.pathname.split('/').pop()||'index.html').toLowerCase();
          header.querySelectorAll('.nav a').forEach(a=>{
            if((a.getAttribute('href')||'').toLowerCase()===fn){ a.setAttribute('aria-current','page'); }
          });
          function setOpen(on){
            header.classList.toggle('menu-open',on);
            if(toggle){ toggle.classList.toggle('menu-open',on); toggle.setAttribute('aria-expanded',on?'true':'false'); }
          }
          toggle && toggle.addEventListener('click', ()=>setOpen(!header.classList.contains('menu-open')));
          nav && nav.addEventListener('click', e=>{ if(e.target.tagName==='A') setOpen(false); });
        });
    })();
  </script>

  <!-- Seasonal logic -->
  <script src="assets/js/seasonal.js?v=final-lock-1"></script>

  <!-- PDF button guard: enable only if PP_PDF exists -->
  <script>
    (function(){
      const btn = document.getElementById('pp-make-pdf');
      function wire(){
        if (window.PP_PDF && typeof window.PP_PDF.generate === 'function') {
          btn.disabled = false;
          btn.onclick = async ()=>{
            try{
              btn.disabled = true; btn.textContent = 'Buildingâ€¦';
              await window.PP_PDF.generate(window.PP_VIEW.getSelection());
            } catch(e){ alert('PDF build failed.'); }
            finally { btn.disabled=false; btn.textContent='ðŸ“„ Download PDF'; }
          };
        } else {
          btn.disabled = true;
          btn.onclick = () => alert('PDF generator not ready.');
        }
      }
      window.addEventListener('load', wire);
    })();
  </script>
</body>
</html>
