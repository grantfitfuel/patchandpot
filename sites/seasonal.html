<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Seasonal Planting Calendar â€¢ Patch & Pot (UK)</title>
  <meta name="description" content="UK seasonal planting calendar for small spaces with Scotland, Ireland, England and Wales variants: what to sow, plant and harvest, plus pest watch.">

  <!-- Global site stylesheet -->
  <link rel="stylesheet" href="style.css?v=pp-54">

  <!-- Seasonal-specific adjustments -->
  <style>
    /* Override opacity bugs */
    html,body,#siteHeader,main,footer{opacity:1!important;filter:none!important}

    /* Force button layout on narrow viewports */
    @media (max-width: 720px){
      .pp-filters{ grid-template-columns: 1fr !important; }
      .pp-filters .right{ justify-content:flex-start; flex-wrap:wrap; }
      #pp-make-pdf{ width:100%; margin-top:.4rem; }
    }
  </style>
</head>
<body>

  <!-- HEADER PARTIAL -->
  <div data-include="partials/header.html"></div>

  <main class="wrap" id="maincontent">
    <h1>Seasonal Planting Calendar (UK)</h1>
    <p class="pp-sub">Small-space sowing, planting &amp; harvesting with regional variants for 
      <strong>Scotland</strong>, <strong>Ireland</strong>, <strong>England</strong> and <strong>Wales</strong>.
    </p>

    <section class="pp-card">
      <div class="pp-toolbar pp-filters" role="group" aria-label="Region and filters">
        <div class="left">
          <label for="pp-region">Region:</label>
          <select id="pp-region" class="pp-select">
            <option value="scotland">Scotland</option>
            <option value="ireland">Ireland</option>
            <option value="england">England</option>
            <option value="wales">Wales</option>
          </select>
          <input id="pp-search" class="pp-search" type="search" placeholder="Search crops (e.g., carrot, basil)â€¦">
          <label for="pp-category" class="sr-only" style="position:absolute;left:-9999px">Category</label>
          <select id="pp-category" class="pp-select">
            <option value="all">All categories</option>
            <option value="leafy">Leafy</option>
            <option value="roots">Roots</option>
            <option value="legumes">Legumes</option>
            <option value="fruit">Fruiting veg</option>
            <option value="alliums">Alliums</option>
            <option value="herbs">Herbs</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div class="right">
          <label for="pp-page">Page:</label>
          <select id="pp-page" class="pp-select">
            <option>Portrait A4</option>
            <option>Landscape A4</option>
          </select>
          <button id="pp-make-pdf" class="btn" type="button">ðŸ“„ Download PDF</button>
          <label style="display:inline-flex;align-items:center;gap:.4rem">
            <input type="checkbox" id="pp-this-month"> <span>Show activity this month only</span>
          </label>
        </div>
      </div>
      <p class="pp-help">Tip: pick a <strong>Region</strong>, type to <strong>search</strong>, choose a <strong>Category</strong>, 
        or toggle <strong>This month only</strong> for a focused view.</p>
    </section>

    <section class="pp-pestwatch" id="pp-pestwatch" aria-labelledby="pestwatch-title">
      <h3 id="pestwatch-title">Pest Watch â€“ <span id="pp-month-name"></span> (<span id="pp-region-name"></span>)</h3>
      <small>Small spaces edition</small>
      <ul><li>Loadingâ€¦</li></ul>
    </section>

    <section class="pp-card" aria-labelledby="today-title">
      <h2 id="today-title">What Can I Plant Today?</h2>
      <p class="pp-month-hint" id="pp-month-hint"></p>
      <ul id="pp-today-list" class="pp-list"></ul>
    </section>

    <div class="pp-legend" aria-hidden="true">
      <span>ðŸŒ± <em>Sow</em></span>
      <span>ðŸª´ <em>Plant</em></span>
      <span>ðŸ¥• <em>Harvest</em></span>
    </div>

    <p class="note-rotate">On a narrow phone, rotate to landscape to see all months.</p>

    <section aria-labelledby="calendar-title">
      <h2 id="calendar-title">Seasonal Planting Calendar</h2>
      <div class="pp-calendar" id="pp-calendar" role="table" aria-label="Seasonal planting calendar"></div>
      <div id="pp-error" class="pp-error" style="display:none"></div>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="footer-inner">
      <img src="img/patchandpot-icon.png" alt="Patch &amp; Pot icon" class="footer-pot" onerror="this.style.display='none'">
      <p>Â© 2025 Patch &amp; Pot | Created by Grant Cameron Anthony</p>
    </div>
  </footer>

  <!-- Header partial loader -->
  <script>
    (function(){
      const holder=document.querySelector('[data-include="partials/header.html"]');
      if(!holder) return;
      fetch('partials/header.html',{cache:'no-store'})
        .then(r=>r.text()).then(html=>{
          holder.outerHTML=html;
          const header=document.getElementById('siteHeader');
          if(!header) return;
          const toggle=header.querySelector('.menu-toggle');
          const nav=header.querySelector('#primaryNav');
          const fn=(location.pathname.split('/').pop()||'index.html').toLowerCase();
          header.querySelectorAll('.nav a').forEach(a=>{
            if((a.getAttribute('href')||'').toLowerCase()===fn){ a.setAttribute('aria-current','page'); }
          });
          function setOpen(on){
            header.classList.toggle('menu-open',on);
            if(toggle){
              toggle.classList.toggle('menu-open',on);
              toggle.setAttribute('aria-expanded',on?'true':'false');
            }
          }
          toggle && toggle.addEventListener('click', ()=>setOpen(!header.classList.contains('menu-open')));
          nav && nav.addEventListener('click', e=>{ if(e.target.tagName==='A') setOpen(false); });
        })
        .catch(()=>{});
    })();
  </script>

  <!-- Seasonal app logic -->
  <script src="assets/js/seasonal-app.js?v=pp-60"></script>

  <!-- PDF libs -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>

  <!-- Our PDF generator (rewritten full version) -->
  <script src="assets/pdf/pdf-generator.js?v=pp-clean"></script>

  <!-- Button wiring -->
  <script>
    window.addEventListener('load', ()=>{
      const btn=document.getElementById('pp-make-pdf');
      if(!btn) return;
      btn.addEventListener('click', async ()=>{
        try{
          btn.disabled=true; btn.textContent='Buildingâ€¦';
          if(!window.PP_PDF || !window.PP_PDF.generate){
            alert('PDF generator not found.'); return;
          }
          const sel=window.PP_VIEW.getSelection();
          const pageSel=document.getElementById('pp-page');
          const page=pageSel ? pageSel.value : 'Portrait A4';
          await window.PP_PDF.generate({ ...sel, page, includeIntro:true });
        }catch(e){
          alert('Sorry, PDF generation failed.');
          console.error(e);
        }finally{
          btn.disabled=false; btn.textContent='ðŸ“„ Download PDF';
        }
      });
    });
  </script>

</body>
</html>
