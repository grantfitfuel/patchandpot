<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Seasonal Planting Calendar â€¢ Patch and Pot (UK)</title>
  <meta name="description" content="UK seasonal planting calendar for small spaces with Scotland, Ireland, England and Wales variants: what to sow, plant and harvest, plus pest watch.">
  <style>
    :root{--pp-green:#2e7d32; --pp-ink:#263238; --pp-border:#dfe5e8;}
    html{font-family: system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif; color:var(--pp-ink); background:#fff;}
    body{margin:0;}
    header{background:linear-gradient(0deg,#e8f5e9, #ffffff); border-bottom:1px solid var(--pp-border)}
    .wrap{max-width:1100px; margin:0 auto; padding:1rem 1.2rem;}
    nav a{margin-right:1rem; text-decoration:none; color:var(--pp-ink)}
    nav a[aria-current="page"]{font-weight:700}
    h1{font-size:clamp(1.5rem,2.8vw,2.2rem); margin:.4rem 0 .2rem}
    .sub{color:#546e7a; margin:0 0 .8rem}
    .pp-toolbar{display:flex; flex-wrap:wrap; gap:.6rem 1rem; align-items:center; padding:.6rem .8rem; background:#f7fdf7; border:1px solid var(--pp-border); border-radius:.6rem}
    .pp-toolbar select{padding:.45rem .6rem; border:1px solid #cfd8dc; border-radius:.45rem}
    .pp-pestwatch{border-left:4px solid var(--pp-green); background:#f1f8e9; padding:1rem; border-radius:.6rem; margin:1rem 0}
    .pp-pestwatch h3{margin:.1rem 0 .2rem; font-size:1.05rem}
    .pp-pestwatch small{display:block; color:#607d8b}
    .pp-pestwatch ul{margin:.4rem 0 0; padding-left:1.1rem}
    .pp-card{background:#fff; border:1px solid var(--pp-border); border-radius:.6rem; padding:1rem; margin:1rem 0}
    .pp-card h2{margin:.2rem 0 .6rem; font-size:1.25rem}
    .pp-month-hint{color:#607d8b; margin:.2rem 0 .6rem}
    .pp-list{list-style:none; padding:0; margin:0}
    .pp-list li{padding:.5rem .6rem; border:1px dashed #cfd8dc; border-radius:.5rem; margin:.4rem 0}
    .pp-calendar{display:grid; grid-template-columns: 200px repeat(12, minmax(52px,1fr)); gap:2px; border:1px solid var(--pp-border); border-radius:.6rem; overflow:hidden}
    .pp-row{display:contents}
    .pp-cell,.pp-head{padding:.5rem .6rem; border:1px solid var(--pp-border); font-size:.95rem}
    .pp-head{font-weight:700; background:#eef5ee}
    .pp-crop{font-weight:700; background:#f7fdf7}
    footer{border-top:1px solid var(--pp-border); margin-top:2rem}
    footer .foot{display:flex; flex-wrap:wrap; gap:.6rem 1rem; align-items:center; justify-content:space-between; color:#607d8b; font-size:.9rem}
    .credit{font-size:.8em; color:#777}
  </style>
</head>
<body>
  <header role="banner">
    <div class="wrap">
      <nav aria-label="Main">
        <a href="index.html">Home</a>
        <a href="growing.html">Growing</a>
        <a href="seasonal.html" aria-current="page">Seasonal</a>
        <a href="recipes.html">Recipes</a>
        <a href="wellbeing.html">Wellbeing</a>
        <a href="exercise.html">Exercise</a>
        <a href="guides.html">Guides</a>
        <a href="ideas.html">Ideas</a>
        <a href="contact.html">Contact</a>
      </nav>
      <h1>Seasonal Planting Calendar (UK)</h1>
      <p class="sub">Small-space sowing, planting &amp; harvesting with regional variants for <strong>Scotland</strong>, <strong>Ireland</strong>, <strong>England</strong> and <strong>Wales</strong>.</p>
    </div>
  </header>

  <main class="wrap" id="maincontent">
    <!-- Controls -->
    <section class="pp-card">
      <div class="pp-toolbar" role="group" aria-label="Region selector">
        <label for="pp-region">Region:</label>
        <select id="pp-region" aria-label="Choose your region">
          <option value="scotland">Scotland</option>
          <option value="ireland">Ireland</option>
          <option value="england">England</option>
          <option value="wales">Wales</option>
        </select>
        <span aria-hidden="true" style="opacity:.7">â€¢</span>
        <span id="pp-today-month" aria-live="polite"></span>
      </div>
    </section>

    <!-- Pest watch -->
    <section class="pp-pestwatch" id="pp-pestwatch" aria-labelledby="pestwatch-title">
      <h3 id="pestwatch-title">Pest Watch</h3>
      <small>Small spaces edition</small>
      <ul><li>Loadingâ€¦</li></ul>
    </section>

    <!-- Today -->
    <section class="pp-card" aria-labelledby="today-title">
      <h2 id="today-title">What Can I Plant Today?</h2>
      <p class="pp-month-hint" id="pp-month-hint"></p>
      <ul id="pp-today-list" class="pp-list"></ul>
    </section>

    <!-- Calendar -->
    <section aria-labelledby="calendar-title">
      <h2 id="calendar-title">Seasonal Planting Calendar</h2>
      <div class="pp-calendar" id="pp-calendar" role="table" aria-label="Seasonal planting calendar"></div>
    </section>
  </main>

  <footer role="contentinfo">
    <div class="wrap foot">
      <div>Â© Patch and Pot â€¢ All Rights Reserved</div>
      <div class="credit">Grant Cameron Anthony</div>
    </div>
  </footer>

  <script>
    const PP_MONTHS = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    const CUR_M = new Date().getMonth(); // 0..11

    let DATA = { scotland:null, ireland:null, england:null, wales:null };

    function setMonthHints(){
      document.getElementById('pp-today-month').textContent = `Itâ€™s ${PP_MONTHS[CUR_M]}.`;
      document.getElementById('pp-month-hint').textContent = `Hereâ€™s what suits containers now in ${PP_MONTHS[CUR_M]}.`;
    }

    function renderPestWatch(regionKey){
      const region = DATA[regionKey];
      const entry = (region.pestwatch && region.pestwatch[String(CUR_M)]) ||
        { title:"Pest Watch", items:["No major alerts this month. Keep an eye on slugs after rain."] };
      const el = document.getElementById('pp-pestwatch');
      el.innerHTML = `
        <h3>${entry.title}</h3>
        <small>${PP_MONTHS[CUR_M]} â€“ small spaces edition</small>
        <ul>${entry.items.map(i=>`<li>${i}</li>`).join("")}</ul>
      `;
    }

    function renderToday(regionKey){
      const region = DATA[regionKey];
      const list = document.getElementById('pp-today-list');
      const items = [];
      (region.crops || []).forEach(c=>{
        const s = (c.months.sow||[]).includes(CUR_M);
        const p = (c.months.plant||[]).includes(CUR_M);
        const h = (c.months.harvest||[]).includes(CUR_M);
        if (s||p||h){
          items.push(`<li><strong>${c.name}</strong> ${s?"ðŸŒ±":""}${p?" ðŸª´":""}${h?" ðŸ¥•":""}</li>`);
        }
      });
      list.innerHTML = items.length ? items.join("") : `<li>No ideal tasks right now. Try prep/cleanup or plan ahead.</li>`;
    }

    function renderCalendar(regionKey){
      const region = DATA[regionKey];
      const wrap = document.getElementById('pp-calendar');
      const head = `
        <div class="pp-row" role="row">
          <div class="pp-head" role="columnheader">Crop</div>
          ${PP_MONTHS.map(m=>`<div class="pp-head" role="columnheader">${m}</div>`).join("")}
        </div>`;
      const rows = (region.crops||[]).map(c=>{
        const cells = PP_MONTHS.map((_, i)=>{
          const s=(c.months.sow||[]).includes(i);
          const p=(c.months.plant||[]).includes(i);
          const h=(c.months.harvest||[]).includes(i);
          const marks = [s?"ðŸŒ±":"","",p?"ðŸª´":"",h?"ðŸ¥•":""].join(" ").trim();
          const label = [s?"Sow":"",p?"Plant":"",h?"Harvest":""].filter(Boolean).join(", ");
          return `<div class="pp-cell" role="cell" aria-label="${c.name} ${PP_MONTHS[i]} ${label}">${marks}</div>`;
        }).join("");
        return `<div class="pp-row" role="row"><div class="pp-cell pp-crop" role="rowheader">${c.name}</div>${cells}</div>`;
      }).join("");
      wrap.innerHTML = head + rows;
    }

    function renderAll(){
      const sel = document.getElementById('pp-region');
      const r = sel.value;
      localStorage.setItem('pp-region', r);
      document.title = `Seasonal Planting (${r[0].toUpperCase()+r.slice(1)}) â€¢ Patch and Pot`;
      setMonthHints();
      renderPestWatch(r);
      renderToday(r);
      renderCalendar(r);
    }

    function init(){
      const sel = document.getElementById('pp-region');
      sel.value = localStorage.getItem('pp-region') || 'scotland';
      sel.addEventListener('change', renderAll);
      renderAll();
    }

    // Load all region files, then init
    Promise.all([
      fetch('data/crops-scotland.json').then(r=>r.json()).then(j=>DATA.scotland=j),
      fetch('data/crops-ireland.json').then(r=>r.json()).then(j=>DATA.ireland=j),
      fetch('data/crops-england.json').then(r=>r.json()).then(j=>DATA.england=j),
      fetch('data/crops-wales.json').then(r=>r.json()).then(j=>DATA.wales=j),
    ]).then(init).catch(err=>{
      console.error('Failed to load data:', err);
      document.getElementById('pp-today-list').innerHTML = '<li>Sorry, data failed to load.</li>';
    });
  </script>
</body>
</html>
